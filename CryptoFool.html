<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CryptoFool</title>
    <style>
        body { font-family: sans-serif; max-width: 385px; margin: 40px auto; padding: 20px; background: #f0f0f8; color: #333; }
    </style>
</head>
<body>

    <div>
        <label>Password:</label>
        <input type="password" id="pass" spellcheck="false" autocomplete="off">
    </div>
    
    <div>
        <label>Salt:</label>
        <input type="text" id="salt" spellcheck="false" autocomplete="off">
        <button onclick="generateAlphanumericSalt()">Gen AlphaNumeric Salt</button>
        <button onclick="generateCustomSalt()">Gen Custom Salt</button>
    </div>
    
    <div>
        <label>Iterations:</label>
        <input type="number" id="iter" value="600000">
    </div>
    
    <div>
        <button onclick="deriveKey()">DERIVE KEY</button>
    </div>
    
    <div>
        <label>Derived Key (Hex):</label>
        <div id="hexKey"></div>
    </div>
    
<script>
    // Generate a alphanumeric salt (A-Z, a-z, 0-9)
    function generateAlphanumericSalt() {
        const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
        let result = "";
        const randomValues = new Uint32Array(16);
        window.crypto.getRandomValues(randomValues);
        
        for (let i = 0; i < 16; i++) {
            result += chars[randomValues[i] % chars.length];
        }
        document.getElementById('salt').value = result;
    }
    
    function generateCustomSalt() {
        const lowers = "abcdefghijkmnopqrstuvwxyz", uppers = "ABCDEFGHJKLMNPQRSTUVWXYZ", digits = "123456789";
        //             excluded:"l"                 excluded:       "I"  "O"             excluded: "0" 
        let result = "", lastType = ""; 
        for (let i = 0; i < 16; i++) {
            let pool = (i === 0) ? lowers + uppers + digits :       /* 1st char can be anything          */  
                       (lastType === 'digit') ? lowers + uppers :   /* after a digit only lower or upper */
                       (lastType === 'lower') ? uppers + digits :   /* after a lower only upper or digit */
                                                lowers + digits ;   /* after a upper only lower or digit */
                       
            const r = window.crypto.getRandomValues(new Uint32Array(1))[0];
            const char = pool[r % pool.length];
            result += char;
            lastType = digits.includes(char) ? 'digit' : lowers.includes(char) ? 'lower' : 'upper';
        }
        document.getElementById('salt').value = result;
    }

    async function deriveKey() {
        const pass = document.getElementById('pass').value;
        const salt = document.getElementById('salt').value;
        const iter = parseInt(document.getElementById('iter').value);

        if (!pass || !salt) {
            alert("password and salt required!");
            return;
        }

        const encoder = new TextEncoder();
        const baseKey = await window.crypto.subtle.importKey(
            "raw", encoder.encode(pass), { name: "PBKDF2" }, false, ["deriveBits"]
        );

        const derivedBits = await window.crypto.subtle.deriveBits(
            {
                name: "PBKDF2",
                salt: encoder.encode(salt),
                iterations: iter,
                hash: "SHA-256"
            },
            baseKey, 256
        );

        const hashHex = Array.from(new Uint8Array(derivedBits))
            .map(b => b.toString(16).padStart(2, '0')).join(' ');
        
        document.getElementById('hexKey').innerText = hashHex;
        document.getElementById('result-area').style.display = 'block';
    }
</script>
</body>
</html>

